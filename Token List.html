<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Live Token Viewer Pro</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gray-900 text-white min-h-screen p-4">
  <div class="flex justify-between mb-4">
    <h1 class="text-2xl font-bold">Live Token Viewer Pro</h1>
    <select id="langSelect" class="bg-gray-800 p-2 rounded">
      <option value="en">üá¨üáß English</option>
      <option value="uk">üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
      <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
    </select>
  </div>
  <label class="block mb-2" data-i18n="searchNetwork">üîé –ü–æ—à—É–∫ –º–µ—Ä–µ–∂—ñ:</label> 
  <input type="text" id="networkSearch" class="mb-4 p-2 w-full bg-gray-800 rounded" placeholder="Ethereum...">
  
  <label class="block mb-2" data-i18n="chooseNetwork">üåê –í–∏–±–µ—Ä—ñ—Ç—å –º–µ—Ä–µ–∂—É:</label> 
  <select id="networkSelect" class="mb-4 p-2 bg-gray-800 rounded w-full"></select>

  <input type="text" id="searchInput" class="w-full p-2 mb-4 bg-gray-800 rounded" placeholder="–ü–æ—à—É–∫ —Ç–æ–∫–µ–Ω–∞..."> 
  <div id="tokenList" class="grid gap-4 md:grid-cols-2 lg:grid-cols-3"></div>
  
  <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
  <div id="pagination" class="mt-6 flex justify-center items-center space-x-4">
    <button id="prevPage" class="px-4 py-2 bg-gray-800 rounded disabled:opacity-50">
      <i class="fas fa-chevron-left"></i>
    </button>
    <span id="pageInfo" class="text-sm">–°—Ç–æ—Ä—ñ–Ω–∫–∞ 1 –∑ 1</span>
    <button id="nextPage" class="px-4 py-2 bg-gray-800 rounded disabled:opacity-50">
      <i class="fas fa-chevron-right"></i>
    </button>
  </div>

  <script>
    const tokenListEl = document.getElementById('tokenList');
    const networkSelect = document.getElementById('networkSelect');
    const searchInput = document.getElementById('searchInput');
    const networkSearch = document.getElementById('networkSearch');
    const langSelect = document.getElementById('langSelect');
    const prevPageBtn = document.getElementById('prevPage');
    const nextPageBtn = document.getElementById('nextPage');
    const pageInfoEl = document.getElementById('pageInfo');

    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
    const ITEMS_PER_PAGE = 50;
    let currentPage = 1;
    let totalPages = 1;
    let filteredTokens = [];

    const PRIORITY_NETWORKS = [
      'ethereum','binance-smart-chain','polygon-pos','arbitrum-one','optimistic-ethereum','avalanche','fantom','base','zksync','solana'
    ];

    let allTokens = [], allPlatforms = [];
    let lang = localStorage.getItem('lang') || 'en';
    langSelect.value = lang;

    const i18n = {
      en: {
        searchNetwork: 'üîé Search network:',
        chooseNetwork: 'üåê Choose network:',
        pageInfo: 'Page {current} of {total}',
        copy: 'Copy',
        copied: 'Copied!'
      },
      uk: {
        searchNetwork: 'üîé –ü–æ—à—É–∫ –º–µ—Ä–µ–∂—ñ:',
        chooseNetwork: 'üåê –í–∏–±–µ—Ä—ñ—Ç—å –º–µ—Ä–µ–∂—É:',
        pageInfo: '–°—Ç–æ—Ä—ñ–Ω–∫–∞ {current} –∑ {total}',
        copy: '–ö–æ–ø—ñ—é–≤–∞—Ç–∏',
        copied: '–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!'
      },
      ru: {
        searchNetwork: 'üîé –ü–æ–∏—Å–∫ —Å–µ—Ç–∏:',
        chooseNetwork: 'üåê –í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ç—å:',
        pageInfo: '–°—Ç—Ä–∞–Ω–∏—Ü–∞ {current} –∏–∑ {total}',
        copy: '–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å',
        copied: '–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!'
      }
    };

    function applyI18n() {
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (i18n[lang][key]) el.textContent = i18n[lang][key];
      });
      updatePageInfo();
    }

    function updatePageInfo() {
      const text = i18n[lang].pageInfo
        .replace('{current}', currentPage)
        .replace('{total}', totalPages);
      pageInfoEl.textContent = text;
    }

    langSelect.addEventListener('change', () => {
      lang = langSelect.value;
      localStorage.setItem('lang', lang);
      applyI18n();
    });

    async function loadNetworks() {
      const res = await fetch('https://api.coingecko.com/api/v3/asset_platforms');
      const platforms = await res.json();
      allPlatforms = platforms;
      renderNetworkOptions();
      const savedNetwork = localStorage.getItem('network');
      if (savedNetwork) {
        networkSelect.value = savedNetwork;
      }
    }

    function renderNetworkOptions() {
      const search = networkSearch.value.toLowerCase();
      networkSelect.innerHTML = '';

      const priority = allPlatforms.filter(p => PRIORITY_NETWORKS.includes(p.id) && p.name.toLowerCase().includes(search));
      const others = allPlatforms.filter(p => !PRIORITY_NETWORKS.includes(p.id) && p.name.toLowerCase().includes(search))
        .sort((a, b) => a.name.localeCompare(b.name));

      [...priority, ...others].forEach(p => {
        const opt = document.createElement('option');
        opt.value = p.id;
        opt.textContent = p.name;
        networkSelect.appendChild(opt);
      });
    }

    async function fetchTokens() {
      const response = await fetch('https://api.coingecko.com/api/v3/coins/list?include_platform=true');
      allTokens = await response.json();
      filterAndRenderTokens();
    }

    function filterTokens() {
      const network = networkSelect.value;
      const search = searchInput.value.toLowerCase();
      localStorage.setItem('network', network);

      return allTokens.filter(token => 
        token.platforms[network] && 
        (token.name.toLowerCase().includes(search) || 
         token.symbol.toLowerCase().includes(search))
      );
    }

    function renderTokens() {
      tokenListEl.innerHTML = '';
      const startIndex = (currentPage - 1) * ITEMS_PER_PAGE;
      const pageTokens = filteredTokens.slice(startIndex, startIndex + ITEMS_PER_PAGE);

      for (const token of pageTokens) {
        const network = networkSelect.value;
        const platformAddress = token.platforms[network];
        const card = document.createElement('div');
        card.className = 'p-4 bg-gray-800 rounded shadow flex flex-col';
        card.innerHTML = `
          <div class="flex-grow">
            <h2 class="text-xl font-semibold">${token.name} (${token.symbol.toUpperCase()})</h2>
            <p class="text-sm text-gray-400 mt-1">Contract: <span class="break-words font-mono">${platformAddress}</span></p>
          </div>
          <div class="flex justify-between items-center mt-3">
            <a href="https://coingecko.com/en/coins/${token.id}" target="_blank" class="text-blue-400 text-sm">Details</a>
            <button class="copy-btn px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded text-sm flex items-center gap-1" data-address="${platformAddress}">
              <i class="far fa-copy"></i>
              <span>${i18n[lang].copy}</span>
            </button>
          </div>
        `;
        tokenListEl.appendChild(card);
      }
    }

    function updatePagination() {
      totalPages = Math.ceil(filteredTokens.length / ITEMS_PER_PAGE) || 1;
      
      prevPageBtn.disabled = currentPage <= 1;
      nextPageBtn.disabled = currentPage >= totalPages;
      
      updatePageInfo();
    }

    function filterAndRenderTokens() {
      filteredTokens = filterTokens();
      currentPage = 1; // –°–±—Ä–æ—Å –Ω–∞ –ø–µ—Ä–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
      renderTokens();
      updatePagination();
    }

    // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
    document.addEventListener('click', (e) => {
      if (e.target.closest('.copy-btn')) {
        const btn = e.target.closest('.copy-btn');
        const address = btn.getAttribute('data-address');
        
        navigator.clipboard.writeText(address).then(() => {
          const originalHTML = btn.innerHTML;
          btn.innerHTML = `<i class="fas fa-check"></i> ${i18n[lang].copied}`;
          btn.classList.add('bg-green-700');
          
          setTimeout(() => {
            btn.innerHTML = originalHTML;
            btn.classList.remove('bg-green-700');
          }, 2000);
        });
      }
    });

    // –ü–∞–≥–∏–Ω–∞—Ü–∏—è
    prevPageBtn.addEventListener('click', () => {
      if (currentPage > 1) {
        currentPage--;
        renderTokens();
        updatePagination();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    });

    nextPageBtn.addEventListener('click', () => {
      if (currentPage < totalPages) {
        currentPage++;
        renderTokens();
        updatePagination();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    });

    // Events
    networkSelect.addEventListener('change', filterAndRenderTokens);
    searchInput.addEventListener('input', filterAndRenderTokens);
    networkSearch.addEventListener('input', renderNetworkOptions);

    // Initial load
    loadNetworks().then(fetchTokens);
    applyI18n();

    // Auto-polling every 60 seconds
    setInterval(fetchTokens, 60000);
  </script>
</body>
</html>