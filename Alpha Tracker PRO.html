<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Alpha Tracker PRO</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/luxon@3.3.0/build/global/luxon.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1.3.1"></script>
  <style>
    :root {
      --primary: #00c853;
      --primary-dark: #009624;
      --secondary: #536dfe;
      --accent: #ff4081;
      --bg-dark: #121212;
      --bg-card: #1e1e1e;
      --bg-hover: #2a2a2a;
      --text: #ffffff;
      --text-secondary: #b0b0b0;
      --border: #333333;
      --success: #4caf50;
      --warning: #ff9800;
      --danger: #f44336;
      --shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background: var(--bg-dark);
      color: var(--text);
      line-height: 1.6;
      padding: 20px;
      background: radial-gradient(circle at top right, #1a1a2e, #121212);
      min-height: 100vh;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
    }
    
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 0;
      border-bottom: 1px solid var(--border);
      margin-bottom: 30px;
      flex-wrap: wrap;
      gap: 20px;
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 15px;
      flex: 1;
      min-width: 250px;
    }
    
    .logo h1 {
      font-size: clamp(1.5rem, 4vw, 2.2rem);
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: 800;
    }
    
    .logo-icon {
      font-size: clamp(1.8rem, 4vw, 2.5rem);
      color: var(--primary);
    }
    
    .search-container {
      display: flex;
      gap: 15px;
      background: var(--bg-card);
      padding: 12px 20px;
      border-radius: 50px;
      box-shadow: var(--shadow);
      align-items: center;
      width: 100%;
      max-width: 400px;
      flex: 1;
    }
    
    .search-container i {
      color: var(--text-secondary);
    }
    
    .search-container input {
      background: transparent;
      border: none;
      color: var(--text);
      font-size: 1rem;
      width: 100%;
      outline: none;
    }
    
    .language-switcher {
      display: flex;
      gap: 8px;
      margin-left: 15px;
    }
    
    .lang-btn {
      background: rgba(255, 255, 255, 0.08);
      border: none;
      color: var(--text);
      padding: 6px 12px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.9rem;
      min-width: 40px;
    }
    
    .lang-btn.active {
      background: var(--primary);
    }
    
    .dashboard-grid {
      display: grid;
      grid-template-columns: minmax(300px, 1fr) 2fr;
      grid-template-areas: "tokens chart";
      gap: 25px;
      margin-bottom: 30px;
      min-height: 70vh;
    }
    
    .tokens-card {
      grid-area: tokens;
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    
    .chart-container {
      grid-area: chart;
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    
    .card {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 25px;
      box-shadow: var(--shadow);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      border: 1px solid var(--border);
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
    }
    
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid var(--border);
    }
    
    .card-title {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: clamp(1.1rem, 2vw, 1.4rem);
      font-weight: 600;
    }
    
    .card-title i {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
    }
    
    .gecko-icon { background: rgba(0, 200, 83, 0.15); color: var(--primary); }
    
    .refresh-btn {
      background: rgba(255, 255, 255, 0.08);
      border: none;
      color: var(--text-secondary);
      width: 32px;
      height: 32px;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .refresh-btn:hover {
      background: var(--primary);
      color: white;
      transform: rotate(90deg);
    }
    
    .list {
      list-style: none;
      flex-grow: 1;
      overflow-y: auto;
      min-height: 300px;
    }
    
    .list-item {
      padding: 15px;
      margin-bottom: 12px;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.05);
      transition: all 0.2s ease;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 15px;
    }
    
    .list-item:hover {
      background: var(--bg-hover);
      transform: translateX(5px);
    }
    
    .token-info {
      display: flex;
      flex-direction: column;
      gap: 5px;
      flex: 1;
      min-width: 0;
    }
    
    .token-name {
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: clamp(0.9rem, 2vw, 1rem);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .token-name img {
      flex-shrink: 0;
    }
    
    .token-symbol {
      color: var(--text-secondary);
      font-size: 0.85rem;
      flex-shrink: 0;
    }
    
    .token-price {
      font-weight: 600;
      font-size: clamp(0.9rem, 2vw, 1.1rem);
      white-space: nowrap;
    }
    
    .price-change {
      font-size: 0.9rem;
      padding: 3px 8px;
      border-radius: 4px;
      font-weight: 600;
      white-space: nowrap;
    }
    
    .positive {
      color: var(--success);
      background: rgba(76, 175, 80, 0.15);
    }
    
    .negative {
      color: var(--danger);
      background: rgba(244, 67, 54, 0.15);
    }
    
    .action-btn {
      background: rgba(255, 255, 255, 0.08);
      border: none;
      color: var(--text);
      padding: 8px 15px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: clamp(0.8rem, 2vw, 0.9rem);
      white-space: nowrap;
    }
    
    .action-btn:hover {
      background: var(--primary);
    }
    
    .chart-container {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 25px;
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
    }
    
    .chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .chart-title {
      font-size: clamp(1.1rem, 2vw, 1.4rem);
      font-weight: 600;
    }
    
    .chart-actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .time-btn {
      background: rgba(255, 255, 255, 0.08);
      border: none;
      color: var(--text);
      padding: 6px 12px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.9rem;
    }
    
    .time-btn.active {
      background: var(--primary);
    }
    
    .chart-wrapper {
      height: 100%;
      position: relative;
      flex-grow: 1;
    }

    .chart-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(30, 30, 30, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
      flex-direction: column;
      gap: 15px;
    }
    
    .loading {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 40px;
      color: var(--text-secondary);
      flex-direction: column;
      gap: 15px;
    }
    
    .loading-spinner {
      width: 50px;
      height: 50px;
      border: 4px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      border-top-color: var(--primary);
      animation: spin 1s linear infinite;
    }
    
    .error {
      background: rgba(244, 67, 54, 0.15);
      color: var(--danger);
      padding: 15px;
      border-radius: 12px;
      text-align: center;
      margin-top: 10px;
    }
    
    .empty-state {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 30px;
      color: var(--text-secondary);
      flex-direction: column;
      gap: 15px;
      text-align: center;
    }
    
    .empty-state i {
      font-size: 3rem;
      opacity: 0.3;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    @media (max-width: 1024px) {
      .dashboard-grid {
        grid-template-columns: 1fr;
        grid-template-areas: 
          "tokens"
          "chart";
        min-height: auto;
      }
      
      .tokens-card .list {
        max-height: 400px;
      }
    }
    
    @media (max-width: 768px) {
      header {
        flex-direction: column;
        align-items: stretch;
      }
      
      .search-container {
        max-width: 100%;
      }
      
      .language-switcher {
        margin-left: 0;
        justify-content: center;
        width: 100%;
      }
      
      .chart-wrapper {
        height: 300px;
      }
      
      .list-item {
        padding: 12px;
        flex-wrap: wrap;
      }
      
      .token-name {
        flex-wrap: wrap;
        white-space: normal;
      }
      
      .action-btn {
        padding: 6px 10px;
      }
      
      .list-item > div:last-child {
        display: flex;
        flex-direction: row;
        width: 100%;
        justify-content: space-between;
        margin-top: 10px;
      }
    }
    
    @media (max-width: 480px) {
      .chart-actions {
        width: 100%;
        justify-content: center;
      }
      
      .chart-header {
        flex-direction: column;
        align-items: stretch;
      }
      
      .list-item {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .list-item > div:last-child {
        flex-direction: column;
        gap: 10px;
        align-items: flex-start;
      }
      
      .action-btn {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">
        <i class="fas fa-chart-line logo-icon"></i>
        <h1>Alpha Tracker PRO</h1>
      </div>
      <div style="display: flex; flex: 1; max-width: 600px; gap: 15px;">
        <div class="search-container">
          <i class="fas fa-search"></i>
          <input type="text" id="search" placeholder="Search tokens...">
        </div>
        <div class="language-switcher">
          <button class="lang-btn active" data-lang="en">EN</button>
          <button class="lang-btn" data-lang="ru">RU</button>
          <button class="lang-btn" data-lang="uk">UK</button>
        </div>
      </div>
    </header>
    
    <div class="dashboard-grid">
      <!-- CoinGecko Section -->
      <div class="card tokens-card">
        <div class="card-header">
          <div class="card-title">
            <i class="fas fa-dragon gecko-icon"></i>
            <span id="gecko-title">New CoinGecko Tokens</span>
          </div>
          <button class="refresh-btn" id="refresh-gecko">
            <i class="fas fa-sync-alt"></i>
          </button>
        </div>
        <ul class="list" id="gecko-list">
          <div class="loading">
            <div class="loading-spinner"></div>
            <div id="loading-text">Loading data...</div>
          </div>
        </ul>
      </div>
      
      <!-- Chart Section -->
      <div class="chart-container">
        <div class="chart-header">
          <div class="chart-title" id="chart-title">📈 Price Chart (7 days)</div>
          <div class="chart-actions">
            <button class="time-btn active" data-range="7" id="time-7">7 days</button>
            <button class="time-btn" data-range="30" id="time-30">30 days</button>
            <button class="time-btn" data-range="90" id="time-90">90 days</button>
          </div>
        </div>
        <div class="chart-wrapper">
          <div id="chart-overlay" class="chart-overlay" style="display: none;">
            <div class="loading-spinner"></div>
            <div id="loading-chart-text">Loading chart...</div>
          </div>
          <canvas id="chart"></canvas>
        </div>
      </div>
    </div>
  </div>

  <script>
    // DOM elements
    const geckoList = document.getElementById("gecko-list");
    const chartEl = document.getElementById("chart");
    const searchInput = document.getElementById("search");
    const chartOverlay = document.getElementById("chart-overlay");
    
    // Language elements
    const langButtons = document.querySelectorAll('.lang-btn');
    const geckoTitle = document.getElementById('gecko-title');
    const loadingText = document.getElementById('loading-text');
    const loadingChartText = document.getElementById('loading-chart-text');
    const chartTitle = document.getElementById('chart-title');
    const timeBtn7 = document.getElementById('time-7');
    const timeBtn30 = document.getElementById('time-30');
    const timeBtn90 = document.getElementById('time-90');
    
    // Translations
    const translations = {
      en: {
        searchPlaceholder: "Search tokens...",
        geckoTitle: "New CoinGecko Tokens",
        loading: "Loading data...",
        loadingChart: "Loading chart...",
        error: "Error loading data. Please refresh the page.",
        emptyState: "No tokens found",
        chartTitle: "📈 Price Chart (7 days)",
        days7: "7 days",
        days30: "30 days",
        days90: "90 days",
        buttonChart: "Chart"
      },
      ru: {
        searchPlaceholder: "Поиск токенов...",
        geckoTitle: "Новые токены CoinGecko",
        loading: "Загрузка данных...",
        loadingChart: "Загрузка графика...",
        error: "Ошибка загрузки данных. Пожалуйста, обновите страницу.",
        emptyState: "Токены не найдены",
        chartTitle: "📈 График цены (7 дней)",
        days7: "7 дней",
        days30: "30 дней",
        days90: "90 дней",
        buttonChart: "График"
      },
      uk: {
        searchPlaceholder: "Пошук токенів...",
        geckoTitle: "Нові токени CoinGecko",
        loading: "Завантаження даних...",
        loadingChart: "Завантаження графіка...",
        error: "Помилка завантаження даних. Спробуйте оновити сторінку.",
        emptyState: "Токени не знайдені",
        chartTitle: "📈 Графік ціни (7 днів)",
        days7: "7 днів",
        days30: "30 днів",
        days90: "90 днів",
        buttonChart: "Графік"
      }
    };
    
    // Current language
    let currentLanguage = 'en';
    
    // Chart variables
    let chart;
    let currentChartData = null;
    let currentChartRange = 7;
    let currentTokenId = 'bitcoin';
    
    // Data stores
    let geckoTokens = [];
    
    // Set language
    function setLanguage(lang) {
      currentLanguage = lang;
      
      // Update UI elements
      searchInput.placeholder = translations[lang].searchPlaceholder;
      geckoTitle.textContent = translations[lang].geckoTitle;
      loadingText.textContent = translations[lang].loading;
      loadingChartText.textContent = translations[lang].loadingChart;
      timeBtn7.textContent = translations[lang].days7;
      timeBtn30.textContent = translations[lang].days30;
      timeBtn90.textContent = translations[lang].days90;
      
      // Update chart title with current range
      updateChartTitle(currentChartRange);
      
      // Re-render token list to update button texts
      if (geckoTokens.length > 0) {
        renderGeckoTokens(geckoTokens);
      }
    }
    
    // Update chart title with current range
    function updateChartTitle(days) {
      const rangeText = {
        7: translations[currentLanguage].days7,
        30: translations[currentLanguage].days30,
        90: translations[currentLanguage].days90
      };
      chartTitle.textContent = `📈 ${translations[currentLanguage].chartTitle.split('(')[0].trim()} (${rangeText[days]})`;
    }
    
    // Format currency
    function formatCurrency(value) {
      return new Intl.NumberFormat('en-US', {
        style: 'currency',
        currency: 'USD',
        minimumFractionDigits: value < 1 ? 4 : 2,
        maximumFractionDigits: value < 1 ? 6 : 2
      }).format(value);
    }
    
    // Format percentage
    function formatPercentage(value) {
      return value.toFixed(2) + '%';
    }
    
    // Show loading state
    function showLoading(element) {
      element.innerHTML = `
        <div class="loading">
          <div class="loading-spinner"></div>
          <div>${translations[currentLanguage].loading}</div>
        </div>
      `;
    }
    
    // Show error state
    function showError(element, message) {
      element.innerHTML = `
        <div class="error">
          <i class="fas fa-exclamation-circle"></i> ${message}
        </div>
      `;
    }
    
    // Show empty state
    function showEmptyState(element, message) {
      element.innerHTML = `
        <div class="empty-state">
          <i class="fas fa-inbox"></i>
          <div>${message}</div>
        </div>
      `;
    }
    
    // CoinGecko API
    async function loadGecko() {
      showLoading(geckoList);
      
      try {
        const response = await fetch("https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_asc&per_page=50&page=1&sparkline=true&price_change_percentage=24h");
        
        if (!response.ok) {
          throw new Error(translations[currentLanguage].error);
        }
        
        const data = await response.json();
        geckoTokens = data;
        renderGeckoTokens(data);
      } catch (error) {
        console.error("CoinGecko error:", error);
        showError(geckoList, translations[currentLanguage].error);
      }
    }
    
    function renderGeckoTokens(tokens) {
      if (!tokens || tokens.length === 0) {
        showEmptyState(geckoList, translations[currentLanguage].emptyState);
        return;
      }
      
      geckoList.innerHTML = tokens.map(token => {
        const priceChange = token.price_change_percentage_24h || 0;
        const changeClass = priceChange >= 0 ? 'positive' : 'negative';
        const changeSign = priceChange >= 0 ? '+' : '';
        
        return `
          <li class="list-item">
            <div class="token-info">
              <div class="token-name">
                <img src="${token.image}" alt="${token.name}" width="24" height="24">
                ${token.name}
                <span class="token-symbol">(${token.symbol.toUpperCase()})</span>
              </div>
              <div class="token-price">${formatCurrency(token.current_price)}</div>
            </div>
            <div>
              <div class="price-change ${changeClass}">${changeSign}${formatPercentage(priceChange)}</div>
              <button class="action-btn" onclick="showTokenChart('${token.id}', ${currentChartRange})">
                <i class="fas fa-chart-line"></i> ${translations[currentLanguage].buttonChart}
              </button>
            </div>
          </li>
        `;
      }).join('');
    }
    
    // Chart functions
    async function showTokenChart(tokenId, days = 7) {
      chartOverlay.style.display = 'flex';
      currentTokenId = tokenId;
      currentChartRange = days;
      
      // Update chart title with new range
      updateChartTitle(days);
      
      try {
        const response = await fetch(`https://api.coingecko.com/api/v3/coins/${tokenId}/market_chart?vs_currency=usd&days=${days}`);
        
        if (!response.ok) {
          throw new Error(translations[currentLanguage].error);
        }
        
        const data = await response.json();
        currentChartData = data;
        renderChart(data, tokenId, days);
        chartOverlay.style.display = 'none';
      } catch (error) {
        console.error("Chart error:", error);
        chartOverlay.innerHTML = `
          <div class="error">
            <i class="fas fa-exclamation-circle"></i> ${translations[currentLanguage].error}
          </div>
        `;
      }
    }
    
    function renderChart(data, tokenId, days) {
      const prices = data.prices;
      const labels = prices.map(price => luxon.DateTime.fromMillis(price[0]).toFormat('dd MMM'));
      const values = prices.map(price => price[1]);
      
      if (chart) {
        chart.destroy();
      }
      
      const ctx = chartEl.getContext('2d');
      chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            label: `${tokenId.toUpperCase()} ${translations[currentLanguage].buttonChart}`,
            data: values,
            borderColor: '#00c853',
            backgroundColor: 'rgba(0, 200, 83, 0.1)',
            borderWidth: 2,
            pointRadius: 0,
            tension: 0.3,
            fill: true
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              labels: {
                color: '#fff',
                font: {
                  size: 14
                }
              }
            },
            tooltip: {
              mode: 'index',
              intersect: false,
              backgroundColor: 'rgba(30, 30, 30, 0.9)',
              titleColor: '#fff',
              bodyColor: '#ddd',
              titleFont: {
                size: 14
              },
              bodyFont: {
                size: 13
              },
              padding: 12,
              borderColor: 'rgba(255, 255, 255, 0.1)',
              borderWidth: 1,
              displayColors: false
            }
          },
          scales: {
            x: {
              grid: {
                color: 'rgba(255, 255, 255, 0.05)'
              },
              ticks: {
                color: '#b0b0b0',
                maxRotation: 0,
                autoSkip: true,
                maxTicksLimit: 10
              }
            },
            y: {
              grid: {
                color: 'rgba(255, 255, 255, 0.05)'
              },
              ticks: {
                color: '#b0b0b0',
                callback: function(value) {
                  return '$' + value.toFixed(2);
                }
              }
            }
          },
          interaction: {
            mode: 'nearest',
            axis: 'x',
            intersect: false
          },
          animation: {
            duration: 1000,
            easing: 'easeOutQuart'
          }
        }
      });
    }
    
    // Event listeners
    searchInput.addEventListener('input', e => {
      const val = e.target.value.toLowerCase();
      const filtered = geckoTokens.filter(t => 
        t.name.toLowerCase().includes(val) || 
        t.symbol.toLowerCase().includes(val)
      );
      renderGeckoTokens(filtered);
    });
    
    // Refresh buttons
    document.getElementById('refresh-gecko').addEventListener('click', loadGecko);
    
    // Time range buttons
    document.querySelectorAll('.time-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.time-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        
        const range = parseInt(this.dataset.range);
        if (currentTokenId) {
          showTokenChart(currentTokenId, range);
        }
      });
    });
    
    // Language switcher
    langButtons.forEach(button => {
      button.addEventListener('click', function() {
        langButtons.forEach(btn => btn.classList.remove('active'));
        this.classList.add('active');
        setLanguage(this.dataset.lang);
      });
    });
    
    // Initialize
    window.addEventListener('DOMContentLoaded', () => {
      // Set default language to English
      setLanguage('en');
      
      loadGecko();
      
      // Show default chart with Bitcoin
      setTimeout(() => {
        showTokenChart('bitcoin', 7);
      }, 1500);
    });
  </script>
</body>
</html>